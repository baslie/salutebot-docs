---
title: "Отправляем email пользователю"
source_url: "https://developers.sber.ru/docs/ru/salutebot/scenario/blocks/sending-email"
description: "Блок Отправка email для чат-ботов | Разработка чат-ботов"
reading_time: 2
badges: ["SaluteBot", "Graph"]
breadcrumbs: ["SaluteBot", "Работаем с данными пользователей", "", "SaluteBot", "Работаем с данными пользователей", "Отправляем email пользователю"]
toc:
  - title: "Параметры блока"
    level: 2
    id: "parametry-bloka"
  - title: "Параметры адреса отправителя"
    level: 2
    id: "parametry-adresa-otpravitelya"
  - title: "Отправка почты в сценарии чат-бота"
    level: 2
    id: "otpravka-pochty-v-stsenarii-chat-bota"
---

<!-- Бейджи: SaluteBot | Graph -->

# Отправляем email пользователю

Содержание раздела

* [Параметры блока](#параметры-блока)
* [Параметры адреса отправителя](#параметры-адреса-отправителя)
* [Отправка почты в сценарии чат-бота](#отправка-почты-в-сценарии-чат-бота)

# Отправляем email пользователю

Обновлено 26 декабря 2023

[![](/assets/scenario/blocks/sending-email/salutebot-new.png)
SaluteBot](../../overview.md)[![](/assets/scenario/blocks/sending-email/Graph.png)
Graph](https://developers.sber.ru/docs/ru/va/graph/overview)

С помощью блока **Отправка email** вы можете отправить электронное письмо на почту пользователя чат-бота.

На одном экране с блоком **Отправка email** можно добавить только блоки [Изображение](https://developers.sber.ru/docs/ru/va/graph/blocks/image), [Текст](https://developers.sber.ru/docs/ru/va/graph/blocks/text), [Аудио](https://developers.sber.ru/docs/ru/va/graph/blocks/audio) и [JS Код](https://developers.sber.ru/docs/ru/va/graph/blocks/jscode).

Для отправки письма вы можете указать данные собственного почтового сервера или выбрать из списка.

В блоке доступно два перехода:

* **Отправлено** — в случае успешной отправки.
* **Ошибка** — если не удалось отправить письмо.

## Параметры блока

Чтобы настроить блок, заполните следующие поля:

* **От кого** E-mail отправителя. Обязательное поле, которое заполняется с помощью адреса из заранее подготовленного списка.
* **Кому** Массив электронных адресов получателей, максимальное количество: 5. Система валидирует адреса, в случае ошибки адрес подсвечивается красным. Обязательное поле.
* **Скрытая копия** Массив электронных адресов получателей, которые не будут отображаться другим получателям, максимальное количество: 5. Может содержать переменные. Система валидирует адреса, в случае ошибки адрес подсвечивается красным. Необязательное поле.
* **Тема** Тема письма, максимальная длина: 500 символов. Может содержать переменные.
* **Тело письма** Максимальная длина: 1000 символов. Может содержать переменные.

## Параметры адреса отправителя

С помощью блока **Отправка email** можно создать список адресов, из которого выбирается адрес для заполнения поля **От кого**. При добавлении адреса отправителя вы можете указать параметры произвольного почтового сервиса или выбрать сервис из списка. При выборе из списка часть параметров заполняется автоматически.

Подробно об особенностях авторизации в сторонних почтовых сервисах читайте в документации к выбранному сервису.

Для добавления адреса нужно заполнить поля:

* **Почтовый сервис**. Укажите сервис, с которого будет отправлено письмо — введите название произвольного сервиса или выберите из списка:

  + **Yandex**.
  + **Mail**.
  + **Rambler**.
  + **Google**.
* **Хост**. Нужно заполнить, если вы указали произвольный почтовый сервис.
* **Порт**. Нужно заполнить, если вы указали произвольный почтовый сервис. Доступные порты:

  + 80
  + 443
  + 465
  + 587
  + 2443
  + 6443
  + 8080
  + 8443
  + 9443
* **Логин**. Логин SMTP-сервера, максимальная длина: 100 символов. Можно использовать переменную.
* **Пароль**. Пароль SMTP-сервера, максимальная длина: 100 символов. Вы можете использовать переменную из выпадающего списка в разделе **Токены** или придумать свой. Если вы придумали свой пароль, его нельзя будет просмотреть после сохранения.
* **Адрес почты отправителя**. Адрес отправителя. Система валидирует адреса, в случае ошибки адрес подсвечивается красным. Обязательное поле.

Примеры настройки популярных сервисов:

* [Яндекс Почта](https://yandex.ru/support/mail/mail-clients/others.html) .
* [Почта Mail.ru](https://help.mail.ru/biz/domain/faq/clients) .
* [Рамблер/почта](https://help.rambler.ru/mail/mail-pochtovye-klienty/1275/) .
* [Gmail](https://support.google.com/mail/answer/7126229?hl=ru) .

## Отправка почты в сценарии чат-бота

Graph
Code

Если вы разрабатываете сценарий в Graph, для отправки почты используйте блок [**Отправка email**](sending-email.md).
По нажатию на поле **От кого** откроется окно **Новый адрес отправителя**.

Для настройки адреса отправителя задайте параметры произвольного почтового сервиса или выберите из списка популярных сервисов.
При выборе почтового сервиса часть полей заполнится автоматически.

В полях **Кому**, **Скрытая копия** и **Письмо** можно использовать [переменные](https://developers.sber.ru/docs/ru/va/graph/variables/create-variables).

Обработайте в сценарии результаты отправки письма с помощью переходов **Отправлено** и **Ошибка**.

Если вы разрабатываете сценарий в Code, для отправки почты используйте методы [`send()`](https://developers.sber.ru/docs/ru/va/code/js-api/services/mail/send) и [`sendMessage()`](https://developers.sber.ru/docs/ru/va/code/js-api/services/mail/send-message) встроенного сервиса [`$mail`](https://developers.sber.ru/docs/ru/va/code/js-api/services/mail/overview).

Укажите параметры доступа к ящику отправителя в разделе `injector.smtp`, в конфигурационном файле `chatbot.yaml`:

```
injector:
    smtp:
        host: smtp.example.ru # адрес SMTP-сервера
        port: 465 # порт SMTP-сервера
        from: sender@example.com # отправитель
        user: sender # пользователь SMTP-сервера
        password: examplePassword # пароль для доступа к SMTP-сервера по IMAP
```

Для отправки простых писем используйте метод `$mail.sendMessage()` в сценарии:

```
    state: ОтправкаПочты
        q!: Отправь письмо
        script:
           $mail.sendMessage("receiver@example.com", "Тема Code", "Тело Code");
```

Используйте метод `$mail.send()` если наряду с адресами получателей, темой и телом письма хотите указать параметры доступа к почтовому ящику отправителя и другие поля сообщения:

```
    state: ОтправкаПочты
        q!: Отправь письмо
        script:
            $mail.send({
                from: "sender1@example.com",
                hiddenCopy: ["hidden@test.com", "hidden1@test.com"],
                to: ["recipient@example.com", "recipient1@example.com"],
                subject: "Тема Code",
                content: "Тело Code",
                smtpHost: "smtp.example.ru",
                smtpPort: "465",
                user: "sender1",
                password: "password"
            });
```

При этом вы можете использовать адрес отправителя отличный от заданного в файле `chatbot.yaml`.

Заметили ошибку?

Выделите текст и нажмите `Ctrl` + `Enter`, чтобы сообщить нам о ней
