---
title: "Тестирование чат-бота в Code"
source_url: "https://developers.sber.ru/docs/ru/salutebot/testing/testing-debugging"
description: "Документация для разработчиков | Разработка чат-ботов"
reading_time: 1
badges: ["SaluteBot", "Code"]
toc:
  - title: "Отладка чат-бота в редактора сценариев"
    level: 2
    id: "otladka-chat-bota-v-redaktora-stsenariev"
  - title: "Автоматическое тестирование"
    level: 2
    id: "testirovanie-proekta"
  - title: "Структура"
    level: 2
    id: "struktura"
  - title: "Переопределение"
    level: 3
    id: "pereopredelenie"
---

<!-- Бейджи: SaluteBot | Code -->

# Тестирование чат-бота в Code

Содержание раздела

* [Отладка чат-бота в редактора сценариев](#отладка-чат-бота-в-редактора-сценариев)
* [Автоматическое тестирование](#автоматическое-тестирование)
* [Структура](#структура)
* [Переопределение](#переопределение)

# Тестирование чат-бота в Code

Обновлено 30 января 2024

[![](/assets/testing/testing-debugging/salutebot-new.png)
SaluteBot](../overview.md)[![](/assets/testing/testing-debugging/Code.png)
Code](https://developers.sber.ru/docs/ru/va/code/overview)

## Отладка чат-бота в редактора сценариев

В Code вы можете отлаживать работу чат-бота в редакторе сценариев.

Для этого используйте тестовый виджет, который позволяет отладить диалог, без тестирования в канале распространения.

Чтобы запустить чат-бот в тестовом виджете:

1. На панели слева откройте вкладку **Редактор** > **Сценарии**.
2. Нажмите кнопку
   ![запустить](/assets/testing/testing-debugging/base64_3_5e882219.png)
   или используйте сочетание клавиш ALT+W.

Code соберет чат-бот и запустит его в тестовом виджете:

![тестовый виджет](/assets/testing/testing-debugging/test-widget-d0345b86229b9625bc544320f976027d.png)

При работе в тестовом виджете обращайте внимание на [логи сервера](https://developers.sber.ru/docs/ru/salutebot/bot-steps/project-structure/server-logs). Они содержат полезную информацию о события и ошибках в чат-боте.

## Автоматическое тестирование

Тесты `.xml` — файлы автоматических тестов, пишутся на языке XML. Тест представляет собой пошаговое описание взаимодействия пользователя со чат-ботом и ожидаемых ответных реакций.

Тесты должны находиться в папке `test`: `папка_проекта/test/ваши_тесты.xml`.

## Структура

Тесты имеют следующую структуру:

```
<test>
    <test-case>
       <q>Запрос пользователя</q>
       <a>Ответ чат-бота</a>
  </test-case>

    <test-case>
        <q>Запрос пользователя</q>
        <a>Ответ чат-бота</a>
    </test-case>
</test>
```

Вместо текста в ответе `<a>` можно указать стейт, в который переходит система. Для этого используется два атрибута: `class` и `state`.

Атрибут `class` указывает на стейт, в который запрос пользователя был классифицирован.
Атрибут `state` — на стейт, из которого был получен ответ. Например:

```
<test>
    <test-case>
        <q>Как дела?</q>
        <a state="/Offtopic/HowAreYou"/>
    </test-case>
</test>
```

Если нужно проверить, что сначала система попадет в один стейт, а потом при помощи `go!` переходит в другой, то можно использовать `class` как атрибут, указывающий на стейт, в который система попала первым. Далее используйте `state` как атрибут, указывающий на стейт, в который система попадает далее.

Если после первого стейта идет последовательность переходов, они также должны быть описаны при помощи атрибута `state`. Например:

```
<test>
    <test-case>
        <q>Как дела?</q>
        <a class="/Offtopic/HowAreYou"/>
        <a state="/Offtopic/Fallback"/>
        <a state="/Offtopic/HowCanIHelpYou"/>
    </test-case>
</test>
```

`class` и `state` могут совпадать. Если проверяется один переход в стейт, целесообразнее использовать один из этих атрибутов при тестировании. Полная запись:

```
<test-case>
    <q>Как дела?</q>
    <a class="/Offtopic/HowAreYou" state="/Offtopic/HowAreYou"/>
</test-case>
```

### Переопределение

Тесты выполняются автоматически при деплое чат-бота, если присутствуют в папке проекта `test`. Это поведение можно переопределить в файле `chatbot.yaml` в секции `tests`.

Секция `tests` может содержать две подсекции `include` и `exclude`, каждая представляет собой список [ant-шаблонов](http://ant.apache.org/manual/dirtasks.html#patterns) с именами файлов.

* `include` — будут выполнены тесты только из тех файлов, которые попадают под шаблоны, перечисленные в этой подсекции.
* `exclude` — из выполнения будут исключены все файлы, которые попадают под шаблоны, перечисленные в этой подсекции.

Например:

```
tests:
    include:
        - tests.xml
        - delivery.xml
        - order.xml
        - cart.xml
        - otherCities.xml
        - sauces.xml
    exclude:
        - time.xml
```

Заметили ошибку?

Выделите текст и нажмите `Ctrl` + `Enter`, чтобы сообщить нам о ней
