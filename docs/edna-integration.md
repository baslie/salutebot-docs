---
title: "Подключаем чат-бот к EDNA"
source_url: "https://github.com/baslie/salutebot-docs/blob/main/docs/edna-integration.md"
description: "Документация для разработчиков | Разработка чат-ботов"
reading_time: 2
badges: ["SaluteBot", "Graph", "Code"]
breadcrumbs: ["SaluteBot", "", "SaluteBot", "Подключаем чат-бот к EDNA"]
toc:
  - title: "Настройка интеграции c платформой EDNA"
    level: 2
    id: "nastroyka-integratsii-s-platformoy-webim"
  - title: "Возможности интеграции"
    level: 2
    id: "vozmozhnosti-integratsii"
  - title: "Ограничения"
    level: 2
    id: "ogranicheniya"
---

<!-- Бейджи: SaluteBot | Graph | Code -->

# Подключаем чат-бот к EDNA

Содержание раздела

* [Настройка интеграции c платформой EDNA](#настройка-интеграции-c-платформой-edna)
* [Возможности интеграции](#возможности-интеграции)
* [Ограничения](#ограничения)

# Подключаем чат-бот к EDNA

Обновлено 19 сентября 2024

[![](/assets/edna-integration/salutebot-new.png)
SaluteBot](overview.md)[![](/assets/edna-integration/Graph.png)
Graph](https://developers.sber.ru/docs/ru/va/graph/overview)[![](/assets/edna-integration/Code.png)
Code](https://developers.sber.ru/docs/ru/va/code/overview)

Edna – платформа для омниканальных коммуникаций с клиентом: от приема обращений и рабочего места оператора до внедрения чат-ботов и сквозных сценариев автоматизации. Вы можете автоматизировать коммуникации в чат-платформе подключив созданный сценарий вашего чат-бота на Code и Graph к чат-платформе EDNA.

## Настройка интеграции c платформой EDNA

Для настройки интеграции:

1. Предварительно [запросите](https://developers.sber.ru/studio/service-request/edna-integration) доступ к EDNA в StudioAdmin.
   При получении заявки в работу вы получите письмо на указанный ранее адрес. После согласования заявки модератором новая интеграция появится в списке интеграций проекта SaluteBot.
2. Откройте проект SaluteBot и перейдите в раздел **Настройки**.
3. В разделе **Чат-платформа** выберите в качестве интеграции EDNA и нажмите **Далее**.
4. Сгенерируйте токен ботовой интеграции в личном кабинете пользователя EDNA и скопируйте его.
5. Введите полученный токен EDNA и нажмите **Добавить**.
6. Откройте проект SaluteBot и перейдите в режим настроек проекта.
7. В качестве интеграции выберите EDNA.
8. Нажмите **Сохранить**, в результате в настройках проекта SaluteBot в качестве выбранной интеграции отобразится EDNA.
9. На этой же вкладке нажмите **Копировать вебхук**, в результате вебхук будет скопирован в буфер обмена и готов для использования в разрабатываемом вами сервисе.
10. Полученный вебхук введите в настройках бота EDNA в следующие поля:

* URL бекенда чат-бота для обработки сообщений клиента.
* URL бекенда чат-бота для инициации диалога с клиентом.

После подключения интеграции вы не сможете изменить токен EDNA. Для изменения токена вам следует удалить добавленную интеграцию EDNA, а затем создать новую.

## Возможности интеграции

В рамках интеграции с EDNA поддерживаются следующие события:

* начало диалога с пользователем;
* обработка входящих текстовых сообщений от пользователей;
* получение изображений и файлов форматов jpeg, jpg, png, pdf, doc, docx, rtf, bmp, ogg, oga, opus от пользователей;
* получение информации об исходном канале, откуда написал пользователь.

**Получение информации о канале, откуда написал пользователь**

Для получения информации о канале, откуда пришел пользователь в сценарии:

Graph
Code

1. Выберите экран в сценарии.
2. Добавьте блок **Текст**, **Условие** или любой другой, в котором поддержаны переменные.
3. Добавьте системную переменную `$userChannel`.
4. В результате при выполнении сценария будет получено значение канала, из которого пришел пользователь.

1. Выберите нужный экран в сценарии.
2. Добавьте системную переменную `$request.userChannel` в тэг ответа, условия или скрипта.
3. В результате при выполнении сценария будет получено значение канала, из которого пришел пользователь.

**Список доступных значений каналов в EDNA**

| Тип | Описание |
| --- | --- |
| WEB | Виджет на сайте |
| EMAIL | Электронная почта |
| TELEGRAM | Telegram |
| VIBER | Viber |
| VIBERPA | Viber сообщество (общий чат) |
| VKONTAKTE | ВКонтакте |
| WHATSAPP | WhatsApp |
| YANDEX | Яндекс. Мессенджер |
| APPLE\_BUSINESS\_CHAT | Apple Business Chat |
| MOBILE | Мобильное SDK, CHAT\_API |

**Закрытие диалога**

Чат-бот может закрыть диалог в Edna Chat Center по его `threadId`. Это действие возможно только для тредов, назначенных на чат-бота, с помощью дополнительной функции `$edna.closeThread(comment)`.
Вызов функции производится в блоке `script`. Для функции обязательно требуется передать значение `comment` - текст комментария, в котором описывается причина или иное пояснение по закрытию треда, например:

```
$edna.closeThread('Текущий диалог бота был переведен на оператора').
```

## Ограничения

В работе интеграции недоступны следущие функциональности:

* Отправка контактных данных пользователем в чат-бот с помощью блока **Отправить данные оператору**. При выполнении в сценарии будет выполнен переход по ошибке.

Заметили ошибку?

Выделите текст и нажмите `Ctrl` + `Enter`, чтобы сообщить нам о ней
